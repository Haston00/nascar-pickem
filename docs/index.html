<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
<script>
  const firebaseConfig = {
    apiKey: "your-api-key",
    authDomain: "your-project.firebaseapp.com",
    projectId: "your-project-id",
    storageBucket: "your-project.appspot.com",
    messagingSenderId: "your-sender-id",
    appId: "your-app-id"
  };
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();

  function login() {
    console.log("Login function called");
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;
    console.log("Attempting to sign in with email:", email);
    auth.signInWithEmailAndPassword(email, password)
      .then((userCredential) => {
        console.log("Login successful:", userCredential.user.email);
        document.getElementById("login").style.display = "none";
        document.getElementById("pool").style.display = "block";
        loadData();
      })
      .catch((error) => {
        console.error("Login failed:", error.code, error.message);
        alert("Login failed: " + error.message);
      });
  }

  function loadData() {
    db.collection("races").doc("current").get().then((doc) => {
      const race = doc.data();
      document.getElementById("race").innerHTML = race.raceName;
      const picks = race.picks;
      let picksHTML = "<table><tr><th>Player</th><th>Driver</th><th>Finish</th><th>Winner</th></tr>";
      picks.forEach(pick => {
        picksHTML += `<tr><td>${pick.player}</td><td>${pick.driver}</td><td>${pick.finish}</td><td>${pick.winner}</td></tr>`;
      });
      picksHTML += "</table>";
      document.getElementById("picks").innerHTML = picksHTML;
    });

    db.collection("standings").get().then((querySnapshot) => {
      let standingsHTML = "<table><tr><th>Player</th><th>Wins</th></tr>";
      querySnapshot.forEach((doc) => {
        standingsHTML += `<tr><td>${doc.id}</td><td>${doc.data().wins}</td></tr>`;
      });
      standingsHTML += "</table>";
      document.getElementById("standings").innerHTML = standingsHTML;
    });

    db.collection("averages").get().then((querySnapshot) => {
      let averagesHTML = "<table><tr><th>Player</th><th>Average Driver Finish</th></tr>";
      querySnapshot.forEach((doc) => {
        averagesHTML += `<tr><td>${doc.id}</td><td>${doc.data().average}</td></tr>`;
      });
      averagesHTML += "</table>";
      document.getElementById("averages").innerHTML = averagesHTML;
    });

    db.collection("races").get().then((querySnapshot) => {
      let historyHTML = "<table id='historyTable'><tr><th>Race</th><th>Player</th><th>Driver</th><th>Finish</th><th>Winner</th></tr>";
      querySnapshot.forEach((doc) => {
        if (doc.id !== "current") {
          const race = doc.data();
          race.picks.forEach(pick => {
            historyHTML += `<tr><td>${race.raceName}</td><td>${pick.player}</td><td>${pick.driver}</td><td>${pick.finish}</td><td>${pick.winner}</td></tr>`;
          });
        }
      });
      historyHTML += "</table>";
      document.getElementById("history").innerHTML = historyHTML;
    });
  }
</script>


  
